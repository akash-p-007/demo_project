<!--This is index page visible to only superadmin and admin.It consists of all the registered user in Table.Panel gived various status information about user depending upon their Approval status-->
<div class='btn-toolbar pull-right'>
  
</div>
<br>
<h2>Listing Users</h2>
<br>

<div class="table-responsive">  
<div id="exTab1" class="container"> 
  <ul  class="nav nav-pills">
    <li class="active">
      <a  href="#1a" data-toggle="tab" id="tab">All Users</a>
    </li>
    <li>
      <a href="#2a" data-toggle="tab" id="tab">Un-Approved Users</a>
    </li>
    <li>
      <a href="#3a" data-toggle="tab" id="tab">Approved Users</a>
    </li>
  

  <div class="tab-content clearfix">
    <div class="tab-pane active" id="1a">        
      <table id="users-table" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="10" width="100%">
        <%= render 'tablehead' %>
        <tbody>
          <% @users.each do |user| %>
            <tr>
              <td><%= link_to "#{user.name}".html_safe, user, "data-toggle" => "modal", 'data-target' => "#show_modal_#{user.id}" , "aria-hidden" => "true"%></td>
                <div class="modal fade" id="show_modal_<%= user.id %>">
                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">                      
                    </div>
                  </div>
                </div>
              <td><%= user.role.name %></td>
              <td><%= user.email %></td>
              <td><%= check_box_tag :approved ,  user.id, user.approved, data: { url: unapproved_user_path(user.id) }, class: 'user-approved', id: "approved_#{user.id.to_s}" %></td>
                
              <td><%= link_to "<i class='glyphicon glyphicon-pencil'></i>&nbsp; Edit".html_safe , edit_user_path(user),"data-toggle" => "modal", 'data-target' => '#edit_modal' unless user.name == "Superadmin" %></td>
              
              <td><%= link_to "<i class='glyphicon glyphicon-remove-sign'></i>&nbsp; Destroy".html_safe, user, method: :delete, data: { confirm: 'Are you sure?' } if user.role_id !='3'  %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div class="tab-pane" id="2a">
      <table id="users-table"  class="table table-striped table-bordered dt-responsive nowrap" cellspacing="10" width="100%">
       <%= render 'tablehead' %>
        <tbody>
          <% @users.each do |user| %>
          <%if !user.approved%>
          <tr>
            <td><%= link_to "#{user.name}".html_safe, user, "data-toggle" => "modal", 'data-target' => "#show_modal2_#{user.id}" %></td>
              <div class="modal fade" id="show_modal2_<%= user.id %>">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content">                      
                  </div>
                </div>
              </div>
            <td><%= user.role.name %></td>
              <td><%= user.email %></td>
              <td><%= check_box_tag :approved ,  user.id, user.approved, data: { url: unapproved_user_path(user.id) }, class: 'user-approved', id: "approved_#{user.id.to_s}" %></td>
              <td><%= link_to "<i class='glyphicon glyphicon-pencil'></i>&nbsp; Edit".html_safe , edit_user_path(user) if user.role_id = 3 %></td>
              <td><%= link_to "<i class='glyphicon glyphicon-remove-sign'></i>&nbsp; Destroy".html_safe, user, method: :delete, data: { confirm: 'Are you sure?' } if user.role.name != '3' %></td>
          </tr>
          <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
      <div class="tab-pane" id="3a">
        <table id="users-table"  class="table table-striped table-bordered dt-responsive nowrap" cellspacing="10" width="100%">
          <%= render 'tablehead' %>
          <tbody>
            <% @users.each do |user| %>
            <%if user.approved %>
              <tr>
              <td><%= link_to "#{user.name}".html_safe, user, "data-toggle" => "modal", 'data-target' => "#show_modal3_#{user.id}" %></td>
                  <div class="modal fade" id="show_modal3_<%= user.id %>">
                    <div class="modal-dialog modal-lg">
                      <div class="modal-content"></div>                      
                    </div>
                  </div>
                <td><%= user.role.name %></td>
                <td><%= user.email %></td>
                <td><%= check_box_tag :approved ,  user.id, user.approved, data: { url: unapproved_user_path(user.id) }, class: 'user-approved', id: "approved_#{user.id.to_s}" %></td>
                <td><%= link_to "<i class='glyphicon glyphicon-pencil'></i>&nbsp; Edit".html_safe , edit_user_path(user) if user.role.name !='Superadmin'  %></td>
                <td><%= link_to "<i class='glyphicon glyphicon-remove-sign'></i>&nbsp; Destroy".html_safe, user, method: :delete, data: { confirm: 'Are you sure?' } if user.role_id != 3 %></td>
              </tr>
              <% end %>
              <% end %>
          </tbody>
        </table>
      </div>      
    </div>
</div>

<div class="modal fade" id="edit_modal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content" aria-hidden="true">                      
    </div>
  </div>
</div>