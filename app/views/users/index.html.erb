<!--This is index page visible to only superadmin and admin.It consists of all the registered user in Table.Panel gived various status information about user depending upon their Approval status-->
  <div class='btn-toolbar pull-right'>
    <div class='btn-group'>
<%= link_to 'Invitation Panel', invitations_path(invitation_accepted_at: nil), class: "btn btn-success"%>    

</div>
</div></div>
<h3>Listing Users</h3>

<div id="exTab1" class="container"> 
  <ul  class="nav nav-pills">
    <li class="active">
      <a  href="#1a" data-toggle="tab">All Users</a>
    </li>
    <li><a href="#2a" data-toggle="tab">Un-Approved Users</a>
    </li>
    <li><a href="#3a" data-toggle="tab">Approved Users</a>
    </li>
    <li><%= link_to 'Create new User', new_user_path %></a>
    </li>
  </ul>

  <div class="tab-content clearfix">
    <div class="tab-pane active" id="1a">        
      <table id="users-table"  class="table table-striped table-bordered dt-responsive nowrap" cellspacing="10" width="100%">
        <thead>
          <tr>
            <th>Name</th>
            <th>Role</th>
            <th>Email</th>
            <th> Approved </th>
            <th >Show </th>
            <th >Edit </th>
            <th >Destroy </th>
           </th>
          </tr>
        </thead>

        <tbody>
          <% @users.each do |user| %>
          <tr>
            <td><%= user.name %></td>
            <td><%= user.role.name %></td>
            <td><%= user.email %></td>
            <td id="<%= user.id %>">
              <%= form_for user, remote: true do |f| %>
              <%= f.check_box :approved %>
              <%= f.submit "change status", class: "btn btn-success" %>
              <%end%>
             <!--  <td>
             <span id="unapproved_status">
             <%= link_to "Approve", unapproved_user_path(user.id), class: "btn btn-success", :method => :put, remote: true %> -->
            </span>
            </td>
            <td><%= link_to "<i class='glyphicon glyphicon-eye-open'></i>&nbsp; Show".html_safe, user %></td>
            <td><%= link_to "<i class='glyphicon glyphicon-pencil'></i>&nbsp; Edit".html_safe , edit_user_path(user) if user.role.name !='Superadmin' %></td>
            <td><%= link_to "<i class='glyphicon glyphicon-remove-sign'></i>&nbsp; Destroy".html_safe, user, method: :delete, data: { confirm: 'Are you sure?' } if user.role.name !='Superadmin' %></td>
          </tr>
              <% end %>
        </tbody>
      </table>
    </div>
    <div class="tab-pane" id="2a">
      <table id="users-table"  class="table table-striped table-bordered dt-responsive nowrap" cellspacing="10" width="100%">
        <thead>
          <tr>
            <th>Name</th>
            <th>Role</th>
            <th>Email</th>
            <th> Approved</th>
            <th >Show </th>
            <th >Edit </th>
            <th>Destroy </th>
          </tr> 
        </thead>
        <tbody>
          <% @users.each do |user| %>
          <%if !user.approved%>
          <tr>
              <td><%= user.name %></td>
              <td><%= user.role.name %></td>
              <td><%= user.email %></td>
              <td id="<%= user.id %>">
                <%= form_for user, remote: true do |f| %>
                <%= f.check_box :approved %>
                <%= f.submit "change status",class: "btn btn-danger"%>
                <%end%>
              </td>
              <td><%= link_to "<i class='glyphicon glyphicon-eye-open'></i>&nbsp; Show".html_safe, user %></td>
              <td><%= link_to "<i class='glyphicon glyphicon-pencil'></i>&nbsp; Edit".html_safe , edit_user_path(user) if user.role.name !='Superadmin' %></td>
              <td><%= link_to "<i class='glyphicon glyphicon-remove-sign'></i>&nbsp; Destroy".html_safe, user, method: :delete, data: { confirm: 'Are you sure?' } if user.role.name !='Superadmin' %></td>
          </tr>
          <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
      <div class="tab-pane" id="3a">
        <table id="users-table"  class="table table-striped table-bordered dt-responsive nowrap" cellspacing="10" width="100%">
          <thead>
            <tr>
              <th>Name</th>
              <th>Role</th>
              <th>Email</th>
              <th> Approved</th>
              <th >Show </th>
              <th >Edit </th>
              <th>Destroy </th>
             </th>  
            </tr>
          </thead>
          <tbody>
            <% @users.each do |user| %>
            <%if user.approved%>
              <tr>
                <td><%= user.name %></td>
                <td><%= user.role.name %></td>
                <td><%= user.email %></td>
                <td id="<%= user.id %>">
                  <%= form_for user, remote: true do |f| %>
                  <%= f.check_box :approved %>
                  <%= f.submit "Change status" , class: "btn btn-success" %>
                  <%end%>
                </td>
                <td><%= link_to "<i class='glyphicon glyphicon-eye-open'></i>&nbsp; Show".html_safe, user %></td>
                <td><%= link_to "<i class='glyphicon glyphicon-pencil'></i>&nbsp; Edit".html_safe , edit_user_path(user) if user.role.name !='Superadmin' %></td>
                <td><%= link_to "<i class='glyphicon glyphicon-remove-sign'></i>&nbsp; Destroy".html_safe, user, method: :delete, data: { confirm: 'Are you sure?' } if user.role.name !='Superadmin' %></td>
              </tr>
              <% end %>
              <% end %>
          </tbody>
        </table>
      </div>      
    </div>
</div>
<br>
<br>
        <!--<%= link_to 'Unapproved Users', unapproved_user_path(@users), remote: true %> -->
    <br>
    <br>
  </div> 
</div>

